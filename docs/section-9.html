<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>9 팩터형 | R for Data Science</title>
  <meta name="description" content="This book will teach you how to do data science with R: You’ll learn how to get your data into R, get it into the most useful structure, transform it, visualise it and model it. In this book, you will find a practicum of skills for data science. Just as a chemist learns how to clean test tubes and stock a lab, you’ll learn how to clean data and draw plots—and many other things besides. These are the skills that allow data science to happen, and here you will find the best practices for doing each of these things with R. You’ll learn how to use the grammar of graphics, literate programming, and reproducible research to save time. You’ll also learn how to manage cognitive resources to facilitate discoveries when wrangling, visualising, and exploring data.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="9 팩터형 | R for Data Science />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://r4ds.had.co.nz/" />
  <meta property="og:image" content="https://r4ds.had.co.nz/cover.png" />
  <meta property="og:description" content="This book will teach you how to do data science with R: You’ll learn how to get your data into R, get it into the most useful structure, transform it, visualise it and model it. In this book, you will find a practicum of skills for data science. Just as a chemist learns how to clean test tubes and stock a lab, you’ll learn how to clean data and draw plots—and many other things besides. These are the skills that allow data science to happen, and here you will find the best practices for doing each of these things with R. You’ll learn how to use the grammar of graphics, literate programming, and reproducible research to save time. You’ll also learn how to manage cognitive resources to facilitate discoveries when wrangling, visualising, and exploring data." />
  <meta name="github-repo" content="hadley/r4ds" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 팩터형 | R for Data Science />
  <meta name="twitter:site" content="@hadley" />
  <meta name="twitter:description" content="This book will teach you how to do data science with R: You’ll learn how to get your data into R, get it into the most useful structure, transform it, visualise it and model it. In this book, you will find a practicum of skills for data science. Just as a chemist learns how to clean test tubes and stock a lab, you’ll learn how to clean data and draw plots—and many other things besides. These are the skills that allow data science to happen, and here you will find the best practices for doing each of these things with R. You’ll learn how to use the grammar of graphics, literate programming, and reproducible research to save time. You’ll also learn how to manage cognitive resources to facilitate discoveries when wrangling, visualising, and exploring data." />
  <meta name="twitter:image" content="https://r4ds.had.co.nz/cover.png" />

<meta name="author" content="Garrett Grolemund">
<meta name="author" content="Hadley Wickham">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="section-8.html">
<link rel="next" href="-.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.3.1/str_view.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="r4ds.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R for Data Science</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>환영합니다</a></li>
<li class="chapter" data-level="1" data-path="section-1.html"><a href="section-1.html"><i class="fa fa-check"></i><b>1</b> 서문</a><ul>
<li class="chapter" data-level="1.1" data-path="section-1.html"><a href="section-1.html#--"><i class="fa fa-check"></i><b>1.1</b> 무엇을 배우게 될까</a></li>
<li class="chapter" data-level="1.2" data-path="section-1.html"><a href="section-1.html#how-this-book-is-organised"><i class="fa fa-check"></i><b>1.2</b> How this book is organised</a></li>
<li class="chapter" data-level="1.3" data-path="section-1.html"><a href="section-1.html#--"><i class="fa fa-check"></i><b>1.3</b> 배우지 않는 것</a><ul>
<li class="chapter" data-level="1.3.1" data-path="section-1.html"><a href="section-1.html#section-1.3.1"><i class="fa fa-check"></i><b>1.3.1</b> 빅데이터</a></li>
<li class="chapter" data-level="1.3.2" data-path="section-1.html"><a href="section-1.html#python-julia-and-friends"><i class="fa fa-check"></i><b>1.3.2</b> Python, Julia, and friends</a></li>
<li class="chapter" data-level="1.3.3" data-path="section-1.html"><a href="section-1.html#non-rectangular-data"><i class="fa fa-check"></i><b>1.3.3</b> Non-rectangular data</a></li>
<li class="chapter" data-level="1.3.4" data-path="section-1.html"><a href="section-1.html#hypothesis-confirmation"><i class="fa fa-check"></i><b>1.3.4</b> Hypothesis confirmation</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="section-1.html"><a href="section-1.html#section-1.4"><i class="fa fa-check"></i><b>1.4</b> 준비하기</a><ul>
<li class="chapter" data-level="1.4.1" data-path="section-1.html"><a href="section-1.html#r"><i class="fa fa-check"></i><b>1.4.1</b> R</a></li>
<li class="chapter" data-level="1.4.2" data-path="section-1.html"><a href="section-1.html#rstudio"><i class="fa fa-check"></i><b>1.4.2</b> RStudio</a></li>
<li class="chapter" data-level="1.4.3" data-path="section-1.html"><a href="section-1.html#tidyverse"><i class="fa fa-check"></i><b>1.4.3</b> Tidyverse</a></li>
<li class="chapter" data-level="1.4.4" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>1.4.4</b> 기타 패키지들</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="section-1.html"><a href="section-1.html#r--"><i class="fa fa-check"></i><b>1.5</b> R 코드 실행하기</a></li>
<li class="chapter" data-level="1.6" data-path="section-1.html"><a href="section-1.html#--"><i class="fa fa-check"></i><b>1.6</b> 도움받기, 더 배우기</a></li>
<li class="chapter" data-level="1.7" data-path="section-1.html"><a href="section-1.html#acknowledgements"><i class="fa fa-check"></i><b>1.7</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.8" data-path="section-1.html"><a href="section-1.html#colophon"><i class="fa fa-check"></i><b>1.8</b> Colophon</a></li>
</ul></li>
<li class="part"><span><b>I 탐색하기</b></span></li>
<li class="chapter" data-level="2" data-path="explore-intro.html"><a href="explore-intro.html"><i class="fa fa-check"></i><b>2</b> 소개</a></li>
<li class="chapter" data-level="3" data-path="visualize.html"><a href="visualize.html"><i class="fa fa-check"></i><b>3</b> 데이터 시각화</a><ul>
<li class="chapter" data-level="3.1" data-path="visualize.html"><a href="visualize.html#section-3.1"><i class="fa fa-check"></i><b>3.1</b> 들어가기</a><ul>
<li class="chapter" data-level="3.1.1" data-path="visualize.html"><a href="visualize.html#-1"><i class="fa fa-check"></i><b>3.1.1</b> 준비하기</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>3.2</b> 첫 단계</a><ul>
<li class="chapter" data-level="3.2.1" data-path="visualize.html"><a href="visualize.html#mpg-"><i class="fa fa-check"></i><b>3.2.1</b> <code>mpg</code> 데이터프레임</a></li>
<li class="chapter" data-level="3.2.2" data-path="visualize.html"><a href="visualize.html#ggplot-"><i class="fa fa-check"></i><b>3.2.2</b> ggplot 생성하기</a></li>
<li class="chapter" data-level="3.2.3" data-path="section-1.html"><a href="section-1.html#--"><i class="fa fa-check"></i><b>3.2.3</b> 그래프 작성 탬플릿</a></li>
<li class="chapter" data-level="3.2.4" data-path="visualize.html"><a href="visualize.html#section-3.2.4"><i class="fa fa-check"></i><b>3.2.4</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="visualize.html"><a href="visualize.html#aesthetic-"><i class="fa fa-check"></i><b>3.3</b> Aesthetic 매핑</a><ul>
<li class="chapter" data-level="3.3.1" data-path="visualize.html"><a href="visualize.html#-1"><i class="fa fa-check"></i><b>3.3.1</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualize.html"><a href="visualize.html#common-problems"><i class="fa fa-check"></i><b>3.4</b> Common problems</a></li>
<li class="chapter" data-level="3.5" data-path="visualize.html"><a href="visualize.html#facet"><i class="fa fa-check"></i><b>3.5</b> 면분할(facet)</a><ul>
<li class="chapter" data-level="3.5.1" data-path="visualize.html"><a href="visualize.html#-2"><i class="fa fa-check"></i><b>3.5.1</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>3.6</b> 기하 객체</a><ul>
<li class="chapter" data-level="3.6.1" data-path="visualize.html"><a href="visualize.html#-3"><i class="fa fa-check"></i><b>3.6.1</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>3.7</b> 통계적 변환</a><ul>
<li class="chapter" data-level="3.7.1" data-path="visualize.html"><a href="visualize.html#-4"><i class="fa fa-check"></i><b>3.7.1</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>3.8</b> 위치 조정</a><ul>
<li class="chapter" data-level="3.8.1" data-path="visualize.html"><a href="visualize.html#-5"><i class="fa fa-check"></i><b>3.8.1</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="visualize.html"><a href="visualize.html#section-3.9"><i class="fa fa-check"></i><b>3.9</b> 좌표계</a><ul>
<li class="chapter" data-level="3.9.1" data-path="visualize.html"><a href="visualize.html#-6"><i class="fa fa-check"></i><b>3.9.1</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="section-1.html"><a href="section-1.html#--"><i class="fa fa-check"></i><b>3.10</b> 그래프 레이어 문법</a></li>
</ul></li>
<li class="part"><span><b>II 길들이기</b></span></li>
<li class="chapter" data-level="4" data-path="wrangle-intro.html"><a href="wrangle-intro.html"><i class="fa fa-check"></i><b>4</b> 소개</a></li>
<li class="chapter" data-level="5" data-path="tibble.html"><a href="tibble.html"><i class="fa fa-check"></i><b>5</b> Tibble</a><ul>
<li class="chapter" data-level="5.1" data-path="visualize.html"><a href="visualize.html#-1"><i class="fa fa-check"></i><b>5.1</b> 들어가기</a><ul>
<li class="chapter" data-level="5.1.1" data-path="visualize.html"><a href="visualize.html#-2"><i class="fa fa-check"></i><b>5.1.1</b> 준비하기</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="tibble.html"><a href="tibble.html#tibbles"><i class="fa fa-check"></i><b>5.2</b> tibble 생성하기</a></li>
<li class="chapter" data-level="5.3" data-path="tibble.html"><a href="tibble.html#tibble-vs.data.frame"><i class="fa fa-check"></i><b>5.3</b> Tibble vs. data.frame</a><ul>
<li class="chapter" data-level="5.3.1" data-path="tibble.html"><a href="tibble.html#section-5.3.1"><i class="fa fa-check"></i><b>5.3.1</b> 화면출력</a></li>
<li class="chapter" data-level="5.3.2" data-path="tibble.html"><a href="tibble.html#section-5.3.2"><i class="fa fa-check"></i><b>5.3.2</b> 서브셋하기</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="section-1.html"><a href="section-1.html#--"><i class="fa fa-check"></i><b>5.4</b> 이전 코드와 상호작용</a></li>
<li class="chapter" data-level="5.5" data-path="tibble.html"><a href="tibble.html#-7"><i class="fa fa-check"></i><b>5.5</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="import.html"><a href="import.html"><i class="fa fa-check"></i><b>6</b> 데이터 불러오기</a><ul>
<li class="chapter" data-level="6.1" data-path="visualize.html"><a href="visualize.html#-2"><i class="fa fa-check"></i><b>6.1</b> 들어가기</a><ul>
<li class="chapter" data-level="6.1.1" data-path="visualize.html"><a href="visualize.html#-3"><i class="fa fa-check"></i><b>6.1.1</b> 준비하기</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="import.html"><a href="import.html#section-6.2"><i class="fa fa-check"></i><b>6.2</b> 시작하기</a><ul>
<li class="chapter" data-level="6.2.1" data-path="import.html"><a href="import.html#-r-"><i class="fa fa-check"></i><b>6.2.1</b> 베이스 R과 비교</a></li>
<li class="chapter" data-level="6.2.2" data-path="import.html"><a href="import.html#-8"><i class="fa fa-check"></i><b>6.2.2</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>6.3</b> 벡터 파싱하기</a><ul>
<li class="chapter" data-level="6.3.1" data-path="import.html"><a href="import.html#section-6.3.1"><i class="fa fa-check"></i><b>6.3.1</b> 숫자</a></li>
<li class="chapter" data-level="6.3.2" data-path="import.html"><a href="import.html#readr-strings"><i class="fa fa-check"></i><b>6.3.2</b> 문자열</a></li>
<li class="chapter" data-level="6.3.3" data-path="import.html"><a href="import.html#readr-factors"><i class="fa fa-check"></i><b>6.3.3</b> 팩터형</a></li>
<li class="chapter" data-level="6.3.4" data-path="import.html"><a href="import.html#readr-datetimes"><i class="fa fa-check"></i><b>6.3.4</b> Dates, date-times, times</a></li>
<li class="chapter" data-level="6.3.5" data-path="import.html"><a href="import.html#-9"><i class="fa fa-check"></i><b>6.3.5</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>6.4</b> 파일 파싱하기</a><ul>
<li class="chapter" data-level="6.4.1" data-path="import.html"><a href="import.html#section-6.4.1"><i class="fa fa-check"></i><b>6.4.1</b> 전략</a></li>
<li class="chapter" data-level="6.4.2" data-path="import.html"><a href="import.html#section-6.4.2"><i class="fa fa-check"></i><b>6.4.2</b> 문제점</a></li>
<li class="chapter" data-level="6.4.3" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>6.4.3</b> 기타 전략</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>6.5</b> 파일에 쓰기</a></li>
<li class="chapter" data-level="6.6" data-path="section-1.html"><a href="section-1.html#--"><i class="fa fa-check"></i><b>6.6</b> 기타 데이터 유형</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>7</b> Tidy Data</a><ul>
<li class="chapter" data-level="7.1" data-path="visualize.html"><a href="visualize.html#-3"><i class="fa fa-check"></i><b>7.1</b> 들어가기</a><ul>
<li class="chapter" data-level="7.1.1" data-path="visualize.html"><a href="visualize.html#-4"><i class="fa fa-check"></i><b>7.1.1</b> 준비하기</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="tidy-data.html"><a href="tidy-data.html#tidy-data-1"><i class="fa fa-check"></i><b>7.2</b> Tidy Data</a><ul>
<li class="chapter" data-level="7.2.1" data-path="tidy-data.html"><a href="tidy-data.html#-10"><i class="fa fa-check"></i><b>7.2.1</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="tidy-data.html"><a href="tidy-data.html#gather--spread"><i class="fa fa-check"></i><b>7.3</b> gather 와 spread</a><ul>
<li class="chapter" data-level="7.3.1" data-path="tidy-data.html"><a href="tidy-data.html#gather"><i class="fa fa-check"></i><b>7.3.1</b> Gather</a></li>
<li class="chapter" data-level="7.3.2" data-path="tidy-data.html"><a href="tidy-data.html#spread"><i class="fa fa-check"></i><b>7.3.2</b> Spread</a></li>
<li class="chapter" data-level="7.3.3" data-path="tidy-data.html"><a href="tidy-data.html#-11"><i class="fa fa-check"></i><b>7.3.3</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="tidy-data.html"><a href="tidy-data.html#separate--unite"><i class="fa fa-check"></i><b>7.4</b> Separate 과 Unite</a><ul>
<li class="chapter" data-level="7.4.1" data-path="tidy-data.html"><a href="tidy-data.html#separate"><i class="fa fa-check"></i><b>7.4.1</b> Separate</a></li>
<li class="chapter" data-level="7.4.2" data-path="tidy-data.html"><a href="tidy-data.html#unite"><i class="fa fa-check"></i><b>7.4.2</b> Unite</a></li>
<li class="chapter" data-level="7.4.3" data-path="tidy-data.html"><a href="tidy-data.html#-12"><i class="fa fa-check"></i><b>7.4.3</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="tidy-data.html"><a href="tidy-data.html#section-7.5"><i class="fa fa-check"></i><b>7.5</b> 결측값</a><ul>
<li class="chapter" data-level="7.5.1" data-path="tidy-data.html"><a href="tidy-data.html#-13"><i class="fa fa-check"></i><b>7.5.1</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>7.6</b> 사례 연구</a><ul>
<li class="chapter" data-level="7.6.1" data-path="tidy-data.html"><a href="tidy-data.html#-14"><i class="fa fa-check"></i><b>7.6.1</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="section-1.html"><a href="section-1.html#--"><i class="fa fa-check"></i><b>7.7</b> 타이디하지 않은 데이터</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="section-8.html"><a href="section-8.html"><i class="fa fa-check"></i><b>8</b> 문자열</a><ul>
<li class="chapter" data-level="8.1" data-path="visualize.html"><a href="visualize.html#-4"><i class="fa fa-check"></i><b>8.1</b> 들어가기</a><ul>
<li class="chapter" data-level="8.1.1" data-path="visualize.html"><a href="visualize.html#-5"><i class="fa fa-check"></i><b>8.1.1</b> 준비하기</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>8.2</b> 문자열 기초</a><ul>
<li class="chapter" data-level="8.2.1" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>8.2.1</b> 문자열 길이</a></li>
<li class="chapter" data-level="8.2.2" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>8.2.2</b> 문자열 결합</a></li>
<li class="chapter" data-level="8.2.3" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>8.2.3</b> 문자열 서브셋하기</a></li>
<li class="chapter" data-level="8.2.4" data-path="section-8.html"><a href="section-8.html#section-8.2.4"><i class="fa fa-check"></i><b>8.2.4</b> 로캘</a></li>
<li class="chapter" data-level="8.2.5" data-path="section-8.html"><a href="section-8.html#-15"><i class="fa fa-check"></i><b>8.2.5</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="section-8.html"><a href="section-8.html#---"><i class="fa fa-check"></i><b>8.3</b> 정규표현식을 이용한 패턴 매칭</a><ul>
<li class="chapter" data-level="8.3.1" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>8.3.1</b> 기초 매칭</a></li>
<li class="chapter" data-level="8.3.2" data-path="section-8.html"><a href="section-8.html#section-8.3.2"><i class="fa fa-check"></i><b>8.3.2</b> 앵커</a></li>
<li class="chapter" data-level="8.3.3" data-path="section-1.html"><a href="section-1.html#--"><i class="fa fa-check"></i><b>8.3.3</b> 문자 클래스와 대체구문</a></li>
<li class="chapter" data-level="8.3.4" data-path="section-8.html"><a href="section-8.html#section-8.3.4"><i class="fa fa-check"></i><b>8.3.4</b> 반복</a></li>
<li class="chapter" data-level="8.3.5" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>8.3.5</b> 그룹화와 역참조</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="section-8.html"><a href="section-8.html#section-8.4"><i class="fa fa-check"></i><b>8.4</b> 도구</a><ul>
<li class="chapter" data-level="8.4.1" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>8.4.1</b> 매칭 탐지</a></li>
<li class="chapter" data-level="8.4.2" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>8.4.2</b> 매칭 추출</a></li>
<li class="chapter" data-level="8.4.3" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>8.4.3</b> 그룹화 매칭</a></li>
<li class="chapter" data-level="8.4.4" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>8.4.4</b> 매칭 치환</a></li>
<li class="chapter" data-level="8.4.5" data-path="section-8.html"><a href="section-8.html#splitting"><i class="fa fa-check"></i><b>8.4.5</b> Splitting</a></li>
<li class="chapter" data-level="8.4.6" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>8.4.6</b> 매치 찾기</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="section-1.html"><a href="section-1.html#--"><i class="fa fa-check"></i><b>8.5</b> 기타 패턴 유형</a><ul>
<li class="chapter" data-level="8.5.1" data-path="section-8.html"><a href="section-8.html#-26"><i class="fa fa-check"></i><b>8.5.1</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="section-1.html"><a href="section-1.html#--"><i class="fa fa-check"></i><b>8.6</b> 정규표현식의 기타 용도</a></li>
<li class="chapter" data-level="8.7" data-path="section-8.html"><a href="section-8.html#stringi"><i class="fa fa-check"></i><b>8.7</b> stringi</a><ul>
<li class="chapter" data-level="8.7.1" data-path="section-8.html"><a href="section-8.html#-27"><i class="fa fa-check"></i><b>8.7.1</b> 연습문제</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="section-9.html"><a href="section-9.html"><i class="fa fa-check"></i><b>9</b> 팩터형</a><ul>
<li class="chapter" data-level="9.1" data-path="visualize.html"><a href="visualize.html#-5"><i class="fa fa-check"></i><b>9.1</b> 들어가기</a><ul>
<li class="chapter" data-level="9.1.1" data-path="visualize.html"><a href="visualize.html#-6"><i class="fa fa-check"></i><b>9.1.1</b> 준비하기</a></li>
<li class="chapter" data-level="9.1.2" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>9.1.2</b> 더 배우기</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>9.2</b> 팩터형 생성하기</a></li>
<li class="chapter" data-level="9.3" data-path="section-9.html"><a href="section-9.html#general-social-survey"><i class="fa fa-check"></i><b>9.3</b> General Social Survey</a><ul>
<li class="chapter" data-level="9.3.1" data-path="section-9.html"><a href="section-9.html#-28"><i class="fa fa-check"></i><b>9.3.1</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="section-1.html"><a href="section-1.html#--"><i class="fa fa-check"></i><b>9.4</b> 팩터 순서 수정하기</a><ul>
<li class="chapter" data-level="9.4.1" data-path="section-9.html"><a href="section-9.html#-29"><i class="fa fa-check"></i><b>9.4.1</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="section-1.html"><a href="section-1.html#--"><i class="fa fa-check"></i><b>9.5</b> 팩터 레벨 수정하기</a><ul>
<li class="chapter" data-level="9.5.1" data-path="section-9.html"><a href="section-9.html#-30"><i class="fa fa-check"></i><b>9.5.1</b> 연습문제</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>10</b> 날짜와 시간</a><ul>
<li class="chapter" data-level="10.1" data-path="visualize.html"><a href="visualize.html#-6"><i class="fa fa-check"></i><b>10.1</b> 들어가기</a><ul>
<li class="chapter" data-level="10.1.1" data-path="tibble.html"><a href="tibble.html#-7"><i class="fa fa-check"></i><b>10.1.1</b> 준비하기</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>10.2</b> 날짜/시간 생성하기</a><ul>
<li class="chapter" data-level="10.2.1" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>10.2.1</b> 문자열에서 생성</a></li>
<li class="chapter" data-level="10.2.2" data-path="section-1.html"><a href="section-1.html#--"><i class="fa fa-check"></i><b>10.2.2</b> 개별 구성요소에서 생성</a></li>
<li class="chapter" data-level="10.2.3" data-path="section-1.html"><a href="section-1.html#--"><i class="fa fa-check"></i><b>10.2.3</b> 기타 유형에서 생성</a></li>
<li class="chapter" data-level="10.2.4" data-path="-.html"><a href="-.html"><i class="fa fa-check"></i><b>10.2.4</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="section-1.html"><a href="section-1.html#--"><i class="fa fa-check"></i><b>10.3</b> 데이트-타임형 구성요소</a><ul>
<li class="chapter" data-level="10.3.1" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>10.3.1</b> 구성요소 가져오기</a></li>
<li class="chapter" data-level="10.3.2" data-path="-.html"><a href="-.html#section-10.3.2"><i class="fa fa-check"></i><b>10.3.2</b> 반올림</a></li>
<li class="chapter" data-level="10.3.3" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>10.3.3</b> 구성요소 설정</a></li>
<li class="chapter" data-level="10.3.4" data-path="-.html"><a href="-.html#-32"><i class="fa fa-check"></i><b>10.3.4</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>10.4</b> 시간 범위</a><ul>
<li class="chapter" data-level="10.4.1" data-path="-.html"><a href="-.html#section-10.4.1"><i class="fa fa-check"></i><b>10.4.1</b> 듀레이션형</a></li>
<li class="chapter" data-level="10.4.2" data-path="-.html"><a href="-.html#section-10.4.2"><i class="fa fa-check"></i><b>10.4.2</b> 피리어드형</a></li>
<li class="chapter" data-level="10.4.3" data-path="-.html"><a href="-.html#section-10.4.3"><i class="fa fa-check"></i><b>10.4.3</b> 인터벌형</a></li>
<li class="chapter" data-level="10.4.4" data-path="-.html"><a href="-.html#section-10.4.4"><i class="fa fa-check"></i><b>10.4.4</b> 요약</a></li>
<li class="chapter" data-level="10.4.5" data-path="-.html"><a href="-.html#-33"><i class="fa fa-check"></i><b>10.4.5</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="-.html"><a href="-.html#section-10.5"><i class="fa fa-check"></i><b>10.5</b> 시간대</a></li>
</ul></li>
<li class="part"><span><b>III 모델</b></span></li>
<li class="chapter" data-level="11" data-path="model-intro.html"><a href="model-intro.html"><i class="fa fa-check"></i><b>11</b> 소개</a><ul>
<li class="chapter" data-level="11.1" data-path="model-intro.html"><a href="model-intro.html#hypothesis-generation-vs.hypothesis-confirmation"><i class="fa fa-check"></i><b>11.1</b> Hypothesis generation vs. hypothesis confirmation</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-9" class="section level1">
<h1><span class="header-section-number">9</span> 팩터형</h1>
<div id="-5" class="section level2">
<h2><span class="header-section-number">9.1</span> 들어가기</h2>
<p>R에서 팩터형은 범주형 변수에 사용되는데, 범주형 변수란 가질 수 있는 값이 미리 고정되고 또 알려진 변수를 말한다. 팩터형은 문자형 벡터를 알파벳순이 아닌 순서로 표시하고 싶을 때도 이용할 수 있다.</p>
<p>역사적으로 팩터형은 문자형보다 다루기가 훨씬 쉬웠다. 이런 이유로 베이스R 의 함수들은 문자형을 자동으로 팩터형으로 변환한다. 즉, 팩터형이 사실 도움이 되지 않는 경우에서도, 나타나는 경우가 많다. 다행스럽게도 tidyverse에서는 이런 경우를 걱정할 필요가 없으며 팩터형이 실제로 유용한 경우에만 집중할 수 있다.</p>
<div id="-6" class="section level3">
<h3><span class="header-section-number">9.1.1</span> 준비하기</h3>
<p>팩터형을 다루기 위해, <strong>forcats</strong> 패키지를 사용할 것인데, 이 패키지에는 범주형 변수(팩터형의 다른 말)에 적용하는 도구들이 있다.<주석> 이 패키지는 팩터형에 적용하는 도우미 함수를 다양하게 제공한다. <strong>forcats</strong> 는 핵심 tidyverse에 포함되어 있지 않기 때문에 명시적으로 로드해야 한다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(forcats)</code></pre></div>
</div>
<div id="-" class="section level3">
<h3><span class="header-section-number">9.1.2</span> 더 배우기</h3>
<p>팩터형에 대해 더 알고 싶으면, 아멜리아 맥나마라(Amelia McNamara) 와 니콜라스 호튼(Nicholas Horton)의 논문, <a href="https://peerj.com/preprints/3163/"><em>Wrangling categorical data in R</em></a> 을 추천한다. 이 논문은 로저 펭(Roger Peng)의 <a href="http://simplystatistics.org/2015/07/24/stringsasfactors-an-unauthorized-biography/"><em>stringsAsFactors: An unauthorized biography</em></a> 와 토마스 럼리(Thomas Lumley)의 <a href="http://notstatschat.tumblr.com/post/124987394001/stringsasfactors-sigh"><em>stringsAsFactors = &lt;sigh&gt;</em></a> 에서 논의한 역사를 담고 있고, 범주형 변수에 대해 이 책에서 설명한 타이디 접근법과 베이스 R 방법을 비교한다. 이 논문의 초기버전은 forcats 패키지를 만드는데 동기를 부여하였다.</p>
</div>
</div>
<div id="-" class="section level2">
<h2><span class="header-section-number">9.2</span> 팩터형 생성하기</h2>
<p>월을 기록한 변수가 있다고 가정하자.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Dec&quot;</span>, <span class="st">&quot;Apr&quot;</span>, <span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Mar&quot;</span>)</code></pre></div>
<p>이 변수를 문자열을 이용하여 기록하면 두 가지 문제가 생긴다.</p>
<ol style="list-style-type: decimal">
<li><p>가능한 달이 열두 개만 있고, 오타가 입력되어도 보호받을 수 없다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Dec&quot;</span>, <span class="st">&quot;Apr&quot;</span>, <span class="st">&quot;Jam&quot;</span>, <span class="st">&quot;Mar&quot;</span>)</code></pre></div></li>
<li><p>유용한 순서로 정렬되지 않는다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sort</span>(x1)
<span class="co">#&gt; [1] &quot;Apr&quot; &quot;Dec&quot; &quot;Jan&quot; &quot;Mar&quot;</span></code></pre></div></li>
</ol>
<p>팩터형을 이용하면 이러한 문제를 모두 해결할 수 있다. 팩터형을 생성하기 위해 유효한 레벨들의 리스트를 생성하는 것부터 시작해야 한다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">month_levels &lt;-<span class="st"> </span><span class="kw">c</span>(
  <span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Feb&quot;</span>, <span class="st">&quot;Mar&quot;</span>, <span class="st">&quot;Apr&quot;</span>, <span class="st">&quot;May&quot;</span>, <span class="st">&quot;Jun&quot;</span>, 
  <span class="st">&quot;Jul&quot;</span>, <span class="st">&quot;Aug&quot;</span>, <span class="st">&quot;Sep&quot;</span>, <span class="st">&quot;Oct&quot;</span>, <span class="st">&quot;Nov&quot;</span>, <span class="st">&quot;Dec&quot;</span>
)</code></pre></div>
<p>이제 팩터형을 생성할 수 있다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y1 &lt;-<span class="st"> </span><span class="kw">factor</span>(x1, <span class="dt">levels =</span> month_levels)
y1
<span class="co">#&gt; [1] Dec Apr Jan Mar</span>
<span class="co">#&gt; Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</span>
<span class="kw">sort</span>(y1)
<span class="co">#&gt; [1] Jan Mar Apr Dec</span>
<span class="co">#&gt; Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</span></code></pre></div>
<p>그리고 이 레벨 집합에 포함되지 않는 값은 조용히 <code>NA</code> 로 변환된다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y2 &lt;-<span class="st"> </span><span class="kw">factor</span>(x2, <span class="dt">levels =</span> month_levels)
y2
<span class="co">#&gt; [1] Dec  Apr  &lt;NA&gt; Mar </span>
<span class="co">#&gt; Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</span></code></pre></div>
<p>경고가 발생되길 원하는 경우에는 <code>readr::parse_factor()</code> 를 사용하면 된다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y2 &lt;-<span class="st"> </span><span class="kw">parse_factor</span>(x2, <span class="dt">levels =</span> month_levels)
<span class="co">#&gt; Warning: 1 parsing failure.</span>
<span class="co">#&gt; row col           expected actual</span>
<span class="co">#&gt;   3  -- value in level set    Jam</span></code></pre></div>
<p>앞의 <code>levels</code> 를 생략하면 데이터로부터 알파벳 순서로 취할 것이다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">factor</span>(x1)
<span class="co">#&gt; [1] Dec Apr Jan Mar</span>
<span class="co">#&gt; Levels: Apr Dec Jan Mar</span></code></pre></div>
<p>때때로 레벨의 순서가 데이터에서 처음으로 등장하는 순서와 일치되길 원할 수 있다. 팩터형 생성 시 레벨을 <code>unique(x)</code> 로 설정하거나 사후적으로는 <code>fct_inorder()</code> 를 사용하면 된다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f1 &lt;-<span class="st"> </span><span class="kw">factor</span>(x1, <span class="dt">levels =</span> <span class="kw">unique</span>(x1))
f1
<span class="co">#&gt; [1] Dec Apr Jan Mar</span>
<span class="co">#&gt; Levels: Dec Apr Jan Mar</span>

f2 &lt;-<span class="st"> </span>x1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">factor</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fct_inorder</span>()
f2
<span class="co">#&gt; [1] Dec Apr Jan Mar</span>
<span class="co">#&gt; Levels: Dec Apr Jan Mar</span></code></pre></div>
<p>만약 유효한 레벨 집합에 직접 접근하려면 <code>levels()</code> 로 할 수 있다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(f2)
<span class="co">#&gt; [1] &quot;Dec&quot; &quot;Apr&quot; &quot;Jan&quot; &quot;Mar&quot;</span></code></pre></div>
</div>
<div id="general-social-survey" class="section level2">
<h2><span class="header-section-number">9.3</span> General Social Survey</h2>
<p>이 장의 남은 부분에서는 <code>forcats::gss_cat</code> 에 초점을 맞출 것이다. 이는 시카고 대학 독립 연구기관인 NORC에서 장기간 수행한 <a href="http://gss.norc.org">General Social Survey</a> 의 샘플 데이터이다. 이 설문조사에는 수천 개의 문항이 있는데, 이 중에서 팩터형과 작업할 때 자주 발생하는 문제를 보여주는 것들을 <code>gss_cat</code> 으로 선택했다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gss_cat
<span class="co">#&gt; # A tibble: 21,483 x 9</span>
<span class="co">#&gt;    year marital     age race  rincome   partyid    relig   denom   tvhours</span>
<span class="co">#&gt;   &lt;int&gt; &lt;fct&gt;     &lt;int&gt; &lt;fct&gt; &lt;fct&gt;     &lt;fct&gt;      &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;</span>
<span class="co">#&gt; 1  2000 Never ma…    26 White $8000 to… Ind,near … Protes… Southe…      12</span>
<span class="co">#&gt; 2  2000 Divorced     48 White $8000 to… Not str r… Protes… Baptis…      NA</span>
<span class="co">#&gt; 3  2000 Widowed      67 White Not appl… Independe… Protes… No den…       2</span>
<span class="co">#&gt; 4  2000 Never ma…    39 White Not appl… Ind,near … Orthod… Not ap…       4</span>
<span class="co">#&gt; 5  2000 Divorced     25 White Not appl… Not str d… None    Not ap…       1</span>
<span class="co">#&gt; 6  2000 Married      25 White $20000 -… Strong de… Protes… Southe…      NA</span>
<span class="co">#&gt; # ... with 2.148e+04 more rows</span></code></pre></div>
<p>(이 데이터셋은 패키지로 제공되기 때문에 <code>?gss_cat</code> 으로 변수들에 관한 자세한 정보를 얻을 수 있다는 것을 잊지 말라.)</p>
<p>팩터형이 티블로 저장되면 해당하는 레벨들을 쉽게 볼 수 없게 된다. 볼 수 있는 한 가지 방법은 <code>count()</code> 이다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gss_cat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>(race)
<span class="co">#&gt; # A tibble: 3 x 2</span>
<span class="co">#&gt;   race      n</span>
<span class="co">#&gt;   &lt;fct&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1 Other  1959</span>
<span class="co">#&gt; 2 Black  3129</span>
<span class="co">#&gt; 3 White 16395</span></code></pre></div>
<p>또는 막대 차트로 볼 수 있다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(gss_cat, <span class="kw">aes</span>(race)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="factors_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>기본적으로 ggplot2는 값이 없는 레벨을 제거한다. 다음과 같이 강제적으로 표시하도록 할 수 있다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(gss_cat, <span class="kw">aes</span>(race)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">drop =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="factors_files/figure-html/unnamed-chunk-15-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>이 레벨들은 유효하지만 이 데이터셋에서 나타나지 않는 값을 나타낸다. dplyr에는 <code>drop</code> 옵션이 아직 없지만 향후 제공될 예정이다.</p>
<p>팩터형으로 작업할 때 자주하는 작업 두 가지는 레벨의 순서를 변경하는 것과 레벨의 값을 변경하는 것이다. 이러한 작업은 다음 절에서 설명한다.</p>
<div id="-28" class="section level3">
<h3><span class="header-section-number">9.3.1</span> 연습문제</h3>
<ol style="list-style-type: decimal">
<li><p><code>rincome</code> (reported income, 보고된 소득)의 분포를 탐색하라. 기본 막대 차트가 이해하기 어려운 이유는 무엇인가? 어떻게 플롯을 개선하겠는가?</p></li>
<li><p>이 설문에서 가장 많은 <code>relig</code> 는 무엇인가? 가장 많은 <code>partyid</code> 는 무엇인가?</p></li>
<li><p><code>denom</code> (denomination, 교파) 은 어떤 <code>relig</code> 에 적용되는가? 테이블로 어떻게 알아낼 수 있는가? 시각화로 어떻게 알아낼 수 있는가?</p></li>
</ol>
</div>
</div>
<div id="--" class="section level2">
<h2><span class="header-section-number">9.4</span> 팩터 순서 수정하기</h2>
<p>시각화에서 팩터 레벨의 순서를 변경하는 것이 유용할 때가 종종 있다. 예를 들어 종교에 따른 하루 TV 시청시간의 평균을 탐색하고 싶다고 가정하자.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">relig_summary &lt;-<span class="st"> </span>gss_cat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(relig) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">age =</span> <span class="kw">mean</span>(age, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
    <span class="dt">tvhours =</span> <span class="kw">mean</span>(tvhours, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
    <span class="dt">n =</span> <span class="kw">n</span>()
  )

<span class="kw">ggplot</span>(relig_summary, <span class="kw">aes</span>(tvhours, relig)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="factors_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>전반적인 패턴이 없기 때문에 이 플롯을 해석하기는 어렵다. <code>fct_reorder()</code> 를 사용하여 <code>relig</code> 의 레벨을 재정렬해서 개선할 수 있다. <code>fct_reorder()</code> 에는 세 개의 인수가 있다.</p>
<ul>
<li><code>f</code> : 레벨을 수정할 팩터</li>
<li><code>x</code> : 레벨을 재정렬하기 위해 사용할 수치형 벡터</li>
<li>선택적으로 <code>fun</code> : <code>f</code> 의 각 값에 대해 <code>x</code> 값이 여러 개가 있을 경우, 사용할 함수. 기본값은 <code>median</code> 이다.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(relig_summary, <span class="kw">aes</span>(tvhours, <span class="kw">fct_reorder</span>(relig, tvhours))) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="factors_files/figure-html/unnamed-chunk-17-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>종교를 재배열하면 ’모름(Don’t know)’ 범주의 사람들이 TV를 훨씬 많이 보고, 힌두교와 다른 동양 종교 사람들이 훨씬 덜 본다는 것을 쉽게 알 수 있다.</p>
<p>좀 더 복잡한 변환을 해야 된다면 <code>aes()</code> 내부보다는 별도의 <code>mutate()</code> 단계에서 변환할 것을 추천한다. 예를 들어 앞의 플롯을 다음과 같이 다시 작성할 수 있다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">relig_summary <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">relig =</span> <span class="kw">fct_reorder</span>(relig, tvhours)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(tvhours, relig)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>()</code></pre></div>
<p>보고된 소득 레벨에 따라 평균 나이가 어떻게 변화하는지를 보여주는 플롯을 유사하게 만들어 보면 어떨까?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rincome_summary &lt;-<span class="st"> </span>gss_cat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(rincome) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">age =</span> <span class="kw">mean</span>(age, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
    <span class="dt">tvhours =</span> <span class="kw">mean</span>(tvhours, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
    <span class="dt">n =</span> <span class="kw">n</span>()
  )

<span class="kw">ggplot</span>(rincome_summary, <span class="kw">aes</span>(age, <span class="kw">fct_reorder</span>(rincome, age))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="factors_files/figure-html/unnamed-chunk-19-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>여기에서 레벨을 임의로 재정렬하는 것은 좋은 생각이 아니다! <code>rincome</code> 은 이미 원칙 있게 정렬되어 있어서 건드리지 말아야 하기 때문이다. <code>fct_reorder()</code> 는 레벨이 임의적으로 정렬된 팩터의 경우에만 사용해야 한다.</p>
<p>한편, ’해당 없음(Not applicable)’을 다른 특별한 레벨들과 함께 앞으로 가져오는 것이 좋다. <code>fct_relevel()</code> 을 사용하면 된다. 이 함수는 팩터, <code>f</code> 와 앞으로 옮기고자 하는 레벨(개수에 관계 없음)을 취한다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(rincome_summary, <span class="kw">aes</span>(age, <span class="kw">fct_relevel</span>(rincome, <span class="st">&quot;Not applicable&quot;</span>))) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="factors_files/figure-html/unnamed-chunk-20-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>‘Not applicable’ 의 평균 연령이 왜 이렇게 높을까?</p>
<p>재정렬이 유용한 경우가 또 있는데, 플롯의 선에 색상을 입힐 때이다. <code>fct_reorder2()</code> 는 가장 큰 <code>x</code> 값과 연관된 <code>y</code> 값으로 팩터를 재정렬 한다. 선 색상은 범례와 정렬되므로 이렇게 하면 플롯을 읽기 쉬워진다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">by_age &lt;-<span class="st"> </span>gss_cat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(age)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>(age, marital) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(age) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n))

<span class="kw">ggplot</span>(by_age, <span class="kw">aes</span>(age, prop, <span class="dt">colour =</span> marital)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">na.rm =</span> <span class="ot">TRUE</span>)

<span class="kw">ggplot</span>(by_age, <span class="kw">aes</span>(age, prop, <span class="dt">colour =</span> <span class="kw">fct_reorder2</span>(marital, age, prop))) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&quot;marital&quot;</span>)</code></pre></div>
<p><img src="factors_files/figure-html/unnamed-chunk-21-1.png" width="50%" /><img src="factors_files/figure-html/unnamed-chunk-21-2.png" width="50%" /></p>
<p>마지막으로, <code>fct_infreq()</code> 를 사용하여 빈도 오름차순으로 레벨을 정렬할 수 있다. 추가 변수가 필요 없기 때문에, 재정렬 방법 중 가장 간단한 유형이다. <code>fct_rev()</code> 와 조합하여 사용할 수 있다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gss_cat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">marital =</span> marital <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fct_infreq</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fct_rev</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(marital)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="factors_files/figure-html/unnamed-chunk-22-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div id="-29" class="section level3">
<h3><span class="header-section-number">9.4.1</span> 연습문제</h3>
<ol style="list-style-type: decimal">
<li><p><code>tvhours</code> 에 의심스러운 큰 숫자들이 몇 있다. 평균(mean)은 좋은 요약값인가?</p></li>
<li><p><code>gss_cat</code> 의 각 팩터형에 대해 레벨의 순서가 임의적인지 원칙적인지를 확인하라.</p></li>
<li><p>’해당 없음’을 레벨 앞으로 옮기면, 왜 플롯의 맨 아래로 옮겨지는가?</p></li>
</ol>
</div>
</div>
<div id="--" class="section level2">
<h2><span class="header-section-number">9.5</span> 팩터 레벨 수정하기</h2>
<p>레벨의 순서를 변경하는 것보다 더 강력한 것은 값을 변경하는 것이다. 이렇게 하면 출판 시 라벨을 명확히 할 수 있고, 레벨을 병합하여 상위 레벨 시각화를 할 수 있다. 가장 일반적이고 강력한 것은 <code>fct_recode()</code> 이다. 이를 사용하여 각 레벨값을 다시 코드하거나, 변경할 수 있다. 예를 들어 <code>gss_cat$partyid</code> 를 보자.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gss_cat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(partyid)
<span class="co">#&gt; # A tibble: 10 x 2</span>
<span class="co">#&gt;   partyid                n</span>
<span class="co">#&gt;   &lt;fct&gt;              &lt;int&gt;</span>
<span class="co">#&gt; 1 No answer            154</span>
<span class="co">#&gt; 2 Don&#39;t know             1</span>
<span class="co">#&gt; 3 Other party          393</span>
<span class="co">#&gt; 4 Strong republican   2314</span>
<span class="co">#&gt; 5 Not str republican  3032</span>
<span class="co">#&gt; 6 Ind,near rep        1791</span>
<span class="co">#&gt; # ... with 4 more rows</span></code></pre></div>
<p>이 레벨들은 짧고 일관성이 없다. 이 레벨들을 풀어쓰고, 병렬 구조를 사용해보자.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gss_cat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">partyid =</span> <span class="kw">fct_recode</span>(partyid,
    <span class="st">&quot;Republican, strong&quot;</span>    =<span class="st"> &quot;Strong republican&quot;</span>,
    <span class="st">&quot;Republican, weak&quot;</span>      =<span class="st"> &quot;Not str republican&quot;</span>,
    <span class="st">&quot;Independent, near rep&quot;</span> =<span class="st"> &quot;Ind,near rep&quot;</span>,
    <span class="st">&quot;Independent, near dem&quot;</span> =<span class="st"> &quot;Ind,near dem&quot;</span>,
    <span class="st">&quot;Democrat, weak&quot;</span>        =<span class="st"> &quot;Not str democrat&quot;</span>,
    <span class="st">&quot;Democrat, strong&quot;</span>      =<span class="st"> &quot;Strong democrat&quot;</span>
  )) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>(partyid)
<span class="co">#&gt; # A tibble: 10 x 2</span>
<span class="co">#&gt;   partyid                   n</span>
<span class="co">#&gt;   &lt;fct&gt;                 &lt;int&gt;</span>
<span class="co">#&gt; 1 No answer               154</span>
<span class="co">#&gt; 2 Don&#39;t know                1</span>
<span class="co">#&gt; 3 Other party             393</span>
<span class="co">#&gt; 4 Republican, strong     2314</span>
<span class="co">#&gt; 5 Republican, weak       3032</span>
<span class="co">#&gt; 6 Independent, near rep  1791</span>
<span class="co">#&gt; # ... with 4 more rows</span></code></pre></div>
<p><code>fct_recode()</code> 는 명시적으로 언급되지 않은 레벨은 그대로 둔다. 존재하지 않은 레벨을 참조하면 경고를 발생한다.</p>
<p>그룹을 결합하려면 이전 레벨들을 같은 새로운 레벨로 할당하면 된다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gss_cat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">partyid =</span> <span class="kw">fct_recode</span>(partyid,
    <span class="st">&quot;Republican, strong&quot;</span>    =<span class="st"> &quot;Strong republican&quot;</span>,
    <span class="st">&quot;Republican, weak&quot;</span>      =<span class="st"> &quot;Not str republican&quot;</span>,
    <span class="st">&quot;Independent, near rep&quot;</span> =<span class="st"> &quot;Ind,near rep&quot;</span>,
    <span class="st">&quot;Independent, near dem&quot;</span> =<span class="st"> &quot;Ind,near dem&quot;</span>,
    <span class="st">&quot;Democrat, weak&quot;</span>        =<span class="st"> &quot;Not str democrat&quot;</span>,
    <span class="st">&quot;Democrat, strong&quot;</span>      =<span class="st"> &quot;Strong democrat&quot;</span>,
    <span class="st">&quot;Other&quot;</span>                 =<span class="st"> &quot;No answer&quot;</span>,
    <span class="st">&quot;Other&quot;</span>                 =<span class="st"> &quot;Don&#39;t know&quot;</span>,
    <span class="st">&quot;Other&quot;</span>                 =<span class="st"> &quot;Other party&quot;</span>
  )) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>(partyid)
<span class="co">#&gt; # A tibble: 8 x 2</span>
<span class="co">#&gt;   partyid                   n</span>
<span class="co">#&gt;   &lt;fct&gt;                 &lt;int&gt;</span>
<span class="co">#&gt; 1 Other                   548</span>
<span class="co">#&gt; 2 Republican, strong     2314</span>
<span class="co">#&gt; 3 Republican, weak       3032</span>
<span class="co">#&gt; 4 Independent, near rep  1791</span>
<span class="co">#&gt; 5 Independent            4119</span>
<span class="co">#&gt; 6 Independent, near dem  2499</span>
<span class="co">#&gt; # ... with 2 more rows</span></code></pre></div>
<p>이 기술은 신중하게 사용해야 한다. 서로 같지 않은 범주들을 함께 묶는다면 잘못된 결과를 도출하게 될 것이다.</p>
<p>다수의 레벨을 병합하고자 하면 <code>fct_recode()</code> 의 변형 함수인 <code>fct_collapse()</code> 가 편리하다. 각각의 새로운 변수에 대해 이전 레벨로 이루어진 벡터를 제공해야 한다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gss_cat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">partyid =</span> <span class="kw">fct_collapse</span>(partyid,
    <span class="dt">other =</span> <span class="kw">c</span>(<span class="st">&quot;No answer&quot;</span>, <span class="st">&quot;Don&#39;t know&quot;</span>, <span class="st">&quot;Other party&quot;</span>),
    <span class="dt">rep =</span> <span class="kw">c</span>(<span class="st">&quot;Strong republican&quot;</span>, <span class="st">&quot;Not str republican&quot;</span>),
    <span class="dt">ind =</span> <span class="kw">c</span>(<span class="st">&quot;Ind,near rep&quot;</span>, <span class="st">&quot;Independent&quot;</span>, <span class="st">&quot;Ind,near dem&quot;</span>),
    <span class="dt">dem =</span> <span class="kw">c</span>(<span class="st">&quot;Not str democrat&quot;</span>, <span class="st">&quot;Strong democrat&quot;</span>)
  )) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>(partyid)
<span class="co">#&gt; # A tibble: 4 x 2</span>
<span class="co">#&gt;   partyid     n</span>
<span class="co">#&gt;   &lt;fct&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1 other     548</span>
<span class="co">#&gt; 2 rep      5346</span>
<span class="co">#&gt; 3 ind      8409</span>
<span class="co">#&gt; 4 dem      7180</span></code></pre></div>
<p>가끔은 플롯이나 테이블을 간단하게 만들기 위해 소규모 그룹 모두를 묶고 싶을 수도 있다. <code>fct_lump()</code> 가 바로 이 작업을 한다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gss_cat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">relig =</span> <span class="kw">fct_lump</span>(relig)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>(relig)
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;   relig          n</span>
<span class="co">#&gt;   &lt;fct&gt;      &lt;int&gt;</span>
<span class="co">#&gt; 1 Protestant 10846</span>
<span class="co">#&gt; 2 Other      10637</span></code></pre></div>
<p>기본 동작은 묶은 그룹이 가장 작은 그룹이 되는 조건을 유지하면서 작은 그룹들을 점진적으로 묶는다. 위의 경우에는 매우 도움이 되지는 않는다. 즉, 이 조사에서 대부분의 미국인이 개신교인 것은 사실이지만, 아마도 우리는 과하게 병합한 것 같다.</p>
<p>대신, <code>n</code> 인수를 사용하여 유지하고 싶은 그룹 개수(other 제외)를 지정할 수 있다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gss_cat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">relig =</span> <span class="kw">fct_lump</span>(relig, <span class="dt">n =</span> <span class="dv">10</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>(relig, <span class="dt">sort =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">print</span>(<span class="dt">n =</span> <span class="ot">Inf</span>)
<span class="co">#&gt; # A tibble: 10 x 2</span>
<span class="co">#&gt;    relig                       n</span>
<span class="co">#&gt;    &lt;fct&gt;                   &lt;int&gt;</span>
<span class="co">#&gt;  1 Protestant              10846</span>
<span class="co">#&gt;  2 Catholic                 5124</span>
<span class="co">#&gt;  3 None                     3523</span>
<span class="co">#&gt;  4 Christian                 689</span>
<span class="co">#&gt;  5 Other                     458</span>
<span class="co">#&gt;  6 Jewish                    388</span>
<span class="co">#&gt;  7 Buddhism                  147</span>
<span class="co">#&gt;  8 Inter-nondenominational   109</span>
<span class="co">#&gt;  9 Moslem/islam              104</span>
<span class="co">#&gt; 10 Orthodox-christian         95</span></code></pre></div>
<div id="-30" class="section level3">
<h3><span class="header-section-number">9.5.1</span> 연습문제</h3>
<ol style="list-style-type: decimal">
<li><p>민주당(Democrat), 공화당(Republican), 독립정당(Independent)의 비율이 시간이 지남에 따라 어떻게 변화했는가?</p></li>
<li><p>어떻게 <code>rincome</code> 을 적은 범주 집합으로 병합할 수 있겠는가?</p></li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="section-8.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="-.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hadley/r4ds/edit/master/factors.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
